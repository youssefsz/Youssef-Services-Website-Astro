---
import ServiceCard from "./ServiceCard.astro";
import { services, MAX_HOMEPAGE_SERVICES } from "../data/services";

// Show only up to MAX_HOMEPAGE_SERVICES on homepage
const displayedServices = services.slice(0, MAX_HOMEPAGE_SERVICES);
const hasMoreServices = services.length > MAX_HOMEPAGE_SERVICES;
const remainingCount = services.length - MAX_HOMEPAGE_SERVICES;
---

<section class="py-32 relative" id="services">
    <!-- Section Background -->
    <div class="absolute inset-0 grid-bg opacity-30"></div>

    <div class="container-main relative z-10">
        <!-- Section Header - Centered -->
        <div class="text-center mb-20">
            <div class="number-display mb-4">// 01</div>
            <h2 class="display-lg mb-6">
                <span class="block">My</span>
                <span class="text-outline">Services</span>
            </h2>
            <p class="text-muted text-lg max-w-2xl mx-auto">
                Premium software solutions ready to scale your business. Click
                any service to learn more.
            </p>
        </div>

        <!-- Services Grid - Modern Adaptive Layout -->
        <div class="services-grid">
            {
                displayedServices.map((service, index) => (
                    <ServiceCard
                        title={service.title}
                        description={service.description}
                        category={service.category}
                        icon={service.icon}
                        index={index}
                    />
                ))
            }
        </div>

        <!-- Show All Services Button (only if more than 6 services) -->
        {
            hasMoreServices && (
                <div class="mt-12 text-center">
                    <a href="/services" class="btn-secondary group">
                        <span>
                            Show All Services
                            <span class="text-accent ml-1">
                                (+{remainingCount} more)
                            </span>
                        </span>
                        <svg
                            class="w-4 h-4 transform group-hover:translate-x-1 transition-transform"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="square"
                                stroke-width="2"
                                d="M17 8l4 4m0 0l-4 4m4-4H3"
                            />
                        </svg>
                    </a>
                </div>
            )
        }

        <!-- Bottom Note -->
        <div
            class="mt-16 pt-16 border-t border-white/5 flex flex-col items-center text-center gap-6"
        >
            <p class="text-muted">
                Each service has its own dedicated page with
                <span class="text-white">full details and pricing.</span>
            </p>
        </div>
    </div>
</section>

<style>
    /* 
     * Modern Adaptive Grid (2026 Best Practice)
     * Uses auto-fit + minmax for truly responsive layouts
     * Works beautifully with any number of items
     */
    .services-grid {
        display: grid;
        gap: 1px;
        background-color: rgba(255, 255, 255, 0.05);

        /* 
         * auto-fit: Creates as many columns as will fit
         * minmax(min(100%, 340px), 1fr): 
         *   - Items are at least 340px (or 100% on small screens)
         *   - Items grow equally to fill available space
         */
        grid-template-columns: repeat(auto-fit, minmax(min(100%, 340px), 1fr));
    }

    /* 
     * For larger screens, enforce 3-column layout for visual consistency
     * This prevents awkward 4 or 5 column layouts on ultra-wide screens
     */
    @media (min-width: 1024px) {
        .services-grid {
            grid-template-columns: repeat(3, 1fr);
        }
    }

    /* 
     * Center items when there are fewer than a full row
     * This is achieved through container queries in modern CSS
     */
    @container (max-width: 680px) {
        .services-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
